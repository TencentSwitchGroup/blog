title: Excel 使用记录
date: 2016-04-12 22:23:00
toc: true
tags: [Excel]
categories: tools
keywords: [office, excel]
description: Excel 使用备忘，主要是函数相关
---

## 数据透视图/表

“插入” -> “数据透视图/表”，功能很强大，可对选定内容进行智能统计、求和、求方差等，免下以下“统计单元格数目”一节的烦杂。

### 如何快速自动统计数据
1. 选择选区
2. `插入`选项卡，选择 `数据透视表` 或 `推荐的数据透视表`
3. 选择右上角 `数据透视表字段` 中要添加到报表的字段，并拖动要统计的字段到右下角的“值”

### 如何快速统计以';'号间隔的文本和自出现的次数

1. 先分列，`数据`选项卡，按分号 `分列`
2. 选择新的区域，通过 `countif` 计算，或者操作到同一列上，然后删除空白行，再通过`数据透视表` 统计。

<!--more-->

## 统计单元格数目

* 统计列满足条件的单元格个数，`COUNTIF` 函数
* 统计列满足多条件的单元格个数，`COUNTIFS` 函数

样例：

* 统计 "total" 标签所有 H 列，值等于 A12 的单元格个数

```
COUNTIF(total!H:H,A12)，
```

* 统计 "total" 标签所有 H 列，值为 "abc" 的单元格个数

```
COUNTIF(total!H:H,"abc")
```

* 统计 "total" 标签所有 H 列，非空单元格个数

```
COUNTIF(total!H:H,"<>")
```

* 统计 "total" 标签所有 H 列，空单元格个数

```
COUNTIF(total!H:H,"")
```

* 统计 "total" 标签所有 A 列值为 `*2015` （此处 `*` 为通配符）且 "total" 标签 I 列值为空的单元格个数

```
COUNTIFS(total!A:A,"*2015",total!I:I,"")
```


## 删除重复数据
`数据` 选项卡 -> `数据工具` 选项组中的 `删除重复项`，按提示操作。

## 删除空白单元格

1. 选择选区
2. `开始` 选项卡，`查找和选择` 中间的三角形，下拉点击 `定位条件`
3. 在弹出的窗口中选择 `空值`
4. 右击被选择的单元格，按行或列删除

## 按日期算周数

类似 `=CEILING(("2011-3-14"-"2011-2-10")/7,1)`，可以把日期改成按日期格式填写内容的单元格

## 饼图数字百分比到小数点后面

右击饼图中的数字，选择`设置数据标签格式`，选择第二个大类 `数据` -> `类别` -> `百分比`，`小数点位数` 为你所需要的。

## 如何删除文本前的空白字符

`trim(A1)`
